2025-08-04 14:08:35,000 - INFO - [logger_setup:49] - Logger configurado com sucesso.
2025-08-04 14:08:35,000 - INFO - [main:21] - ============================== INÍCIO DO PROCESSO DE AUTOMAÇÃO ==============================
2025-08-04 14:08:35,000 - INFO - [state_manager:29] - Estado anterior carregado com sucesso de './state.json'.
2025-08-04 14:08:35,001 - INFO - [main:25] - --- ESTÁGIO 1: Carregando arquivos de dados ---
2025-08-04 14:08:35,001 - INFO - [data_loader:29] - Arquivo mais recente encontrado para 'MAILING_NUCLEO_*.xlsx': MAILING_NUCLEO_2025-07-30.xlsx
2025-08-04 14:08:35,001 - INFO - [data_loader:35] - Carregando arquivo Excel: MAILING_NUCLEO_2025-07-30.xlsx...
2025-08-04 14:13:16,119 - INFO - [logger_setup:49] - Logger configurado com sucesso.
2025-08-04 14:13:16,120 - INFO - [main:21] - ============================== INÍCIO DO PROCESSO DE AUTOMAÇÃO ==============================
2025-08-04 14:13:16,120 - INFO - [state_manager:29] - Estado anterior carregado com sucesso de './state.json'.
2025-08-04 14:13:16,120 - INFO - [main:25] - --- ESTÁGIO 1: Carregando arquivos de dados ---
2025-08-04 14:13:16,120 - INFO - [data_loader:29] - Arquivo mais recente encontrado para 'MAILING_NUCLEO_*.xlsx': MAILING_NUCLEO_2025-07-30.xlsx
2025-08-04 14:13:16,120 - INFO - [data_loader:35] - Carregando arquivo Excel: MAILING_NUCLEO_2025-07-30.xlsx...
2025-08-04 14:16:44,370 - INFO - [data_loader:43] - Carregado com sucesso. 252981 linhas.
2025-08-04 14:16:44,371 - INFO - [data_loader:57] - Carregando arquivos de PAGAMENTOS com o padrão 'PAGOS_*.csv'...
2025-08-04 14:16:55,791 - INFO - [data_loader:78] - Carregados e concatenados 9 arquivos de pagamento, totalizando 7938289 linhas.
2025-08-04 14:16:55,969 - WARNING - [data_loader:24] - Arquivo opcional com padrão 'Dump_TabAuto_*.txt' não encontrado. Continuando.
2025-08-04 14:16:55,969 - INFO - [data_loader:35] - Carregando arquivo Excel: Pontuação.xlsx...
2025-08-04 14:16:55,970 - CRITICAL - [data_loader:119] - Processo abortado: Arquivo de entrada crítico não encontrado. Detalhe: [Errno 2] No such file or directory: 'data_input/Pontuação.xlsx'
2025-08-04 14:16:55,970 - CRITICAL - [main:43] - PROCESSO ABORTADO: Ocorreu um erro fatal.
Traceback (most recent call last):
  File "/home/vitoriamaria/Documentos/Controle de Bordo/Trabalhos/Energisa/automação/automacao_energisa/main.py", line 26, in main
    all_dataframes = load_all_data(config)
  File "/home/vitoriamaria/Documentos/Controle de Bordo/Trabalhos/Energisa/automação/automacao_energisa/src/data_loader.py", line 109, in load_all_data
    dataframes['enriquecimento'] = load_excel_data(enriquecimento_path, all_sheets=True)
  File "/home/vitoriamaria/Documentos/Controle de Bordo/Trabalhos/Energisa/automação/automacao_energisa/src/data_loader.py", line 47, in load_excel_data
    xls = pd.ExcelFile(path)
  File "/home/vitoriamaria/Documentos/Controle de Bordo/Trabalhos/Energisa/automação/automacao_energisa/venv/lib/python3.10/site-packages/pandas/io/excel/_base.py", line 1550, in __init__
    ext = inspect_excel_format(
  File "/home/vitoriamaria/Documentos/Controle de Bordo/Trabalhos/Energisa/automação/automacao_energisa/venv/lib/python3.10/site-packages/pandas/io/excel/_base.py", line 1402, in inspect_excel_format
    with get_handle(
  File "/home/vitoriamaria/Documentos/Controle de Bordo/Trabalhos/Energisa/automação/automacao_energisa/venv/lib/python3.10/site-packages/pandas/io/common.py", line 882, in get_handle
    handle = open(handle, ioargs.mode)
FileNotFoundError: [Errno 2] No such file or directory: 'data_input/Pontuação.xlsx'
2025-08-04 15:05:44,736 - INFO - [logger_setup:49] - Logger configurado com sucesso.
2025-08-04 15:05:44,736 - INFO - [main:21] - ============================== INÍCIO DO PROCESSO DE AUTOMAÇÃO ==============================
2025-08-04 15:05:44,737 - INFO - [state_manager:29] - Estado anterior carregado com sucesso de './state.json'.
2025-08-04 15:05:44,737 - INFO - [main:25] - --- ESTÁGIO 1: Carregando arquivos de dados ---
2025-08-04 15:05:44,737 - INFO - [data_loader:29] - Arquivo mais recente encontrado para 'MAILING_NUCLEO_*.xlsx': MAILING_NUCLEO_2025-07-30.xlsx
2025-08-04 15:05:44,737 - INFO - [data_loader:35] - Carregando arquivo Excel: MAILING_NUCLEO_2025-07-30.xlsx...
2025-08-04 15:09:15,940 - INFO - [data_loader:43] - Carregado com sucesso. 252981 linhas.
2025-08-04 15:09:15,940 - INFO - [data_loader:57] - Carregando arquivos de PAGAMENTOS com o padrão 'PAGOS_*.csv'...
2025-08-04 15:09:26,732 - INFO - [data_loader:78] - Carregados e concatenados 9 arquivos de pagamento, totalizando 7938289 linhas.
2025-08-04 15:09:26,893 - WARNING - [data_loader:24] - Arquivo opcional com padrão 'Dump_TabAuto_*.txt' não encontrado. Continuando.
2025-08-04 15:09:26,893 - INFO - [data_loader:35] - Carregando arquivo Excel: Pontuação.xlsx...
2025-08-04 15:09:35,633 - INFO - [data_loader:49] - Carregado com sucesso. Encontradas 2 abas.
2025-08-04 15:09:35,633 - INFO - [data_loader:35] - Carregando arquivo Excel: Negociações SINED.xlsx...
2025-08-04 15:09:50,475 - INFO - [data_loader:43] - Carregado com sucesso. 97690 linhas.
2025-08-04 15:09:50,476 - INFO - [data_loader:35] - Carregando arquivo Excel: Tabulações para Retirar.xlsx...
2025-08-04 15:09:51,334 - INFO - [data_loader:43] - Carregado com sucesso. 13033 linhas.
2025-08-04 15:09:51,334 - INFO - [data_loader:117] - Todos os arquivos de dados foram carregados com sucesso.
2025-08-04 15:09:51,334 - INFO - [main:27] - --- ESTÁGIO 1 CONCLUÍDO ---
2025-08-04 15:09:51,334 - INFO - [main:29] - --- ESTÁGIO 2: Processando dados (Alquimia) ---
2025-08-04 15:09:51,334 - INFO - [processing_pipeline:108] - >>> INICIANDO PIPELINE DE PROCESSAMENTO DE DADOS <<<
2025-08-04 15:09:51,632 - INFO - [processing_pipeline:63] - Iniciando higienização da base...
2025-08-04 15:09:51,726 - INFO - [processing_pipeline:34] - Deduplicação: Removidos 169644 registros duplicados com base na coluna 'NCPF'.
2025-08-04 15:09:51,726 - INFO - [processing_pipeline:70] - Higienização concluída. Registros restantes: 83337
2025-08-04 15:09:51,726 - INFO - [processing_pipeline:45] - Adicionando nova coluna de verificação (placeholder)...
2025-08-04 15:09:51,726 - WARNING - [processing_pipeline:47] - Base de dados para nova coluna não foi carregada ou definida. Coluna será preenchida com 'NÃO'.
2025-08-04 15:09:51,727 - INFO - [processing_pipeline:75] - Criando e formatando colunas finais...
2025-08-04 15:09:51,877 - INFO - [processing_pipeline:120] - >>> PIPELINE DE PROCESSAMENTO DE DADOS CONCLUÍDO <<<
2025-08-04 15:09:51,890 - INFO - [main:31] - --- ESTÁGIO 2 CONCLUÍDO ---
2025-08-04 15:09:51,890 - INFO - [main:33] - --- ESTÁGIO 3: Exportando arquivos finais ---
2025-08-04 15:09:51,890 - INFO - [data_exporter:14] - Iniciando exportação dos dados processados...
2025-08-04 15:09:51,894 - INFO - [data_exporter:30] - Encontrados 9 produtos únicos para particionamento.
2025-08-04 15:09:51,904 - INFO - [data_exporter:36] - Exportando 5305 linhas para o produto 'EAC' em 'data_output/Telecobranca_TOI_EAC_04_08_2025.csv'...
2025-08-04 15:09:51,922 - INFO - [data_exporter:36] - Exportando 218 linhas para o produto 'EMR' em 'data_output/Telecobranca_TOI_EMR_04_08_2025.csv'...
2025-08-04 15:09:51,924 - INFO - [data_exporter:36] - Exportando 5709 linhas para o produto 'EMS' em 'data_output/Telecobranca_TOI_EMS_04_08_2025.csv'...
2025-08-04 15:09:51,938 - INFO - [data_exporter:36] - Exportando 21617 linhas para o produto 'EMT' em 'data_output/Telecobranca_TOI_EMT_04_08_2025.csv'...
2025-08-04 15:09:51,994 - INFO - [data_exporter:36] - Exportando 14718 linhas para o produto 'EPB' em 'data_output/Telecobranca_TOI_EPB_04_08_2025.csv'...
2025-08-04 15:09:52,032 - INFO - [data_exporter:36] - Exportando 26025 linhas para o produto 'ERO' em 'data_output/Telecobranca_TOI_ERO_04_08_2025.csv'...
2025-08-04 15:09:52,100 - INFO - [data_exporter:36] - Exportando 8480 linhas para o produto 'ESE' em 'data_output/Telecobranca_TOI_ESE_04_08_2025.csv'...
2025-08-04 15:09:52,123 - INFO - [data_exporter:36] - Exportando 212 linhas para o produto 'ESS' em 'data_output/Telecobranca_TOI_ESS_04_08_2025.csv'...
2025-08-04 15:09:52,124 - INFO - [data_exporter:36] - Exportando 1053 linhas para o produto 'ETO' em 'data_output/Telecobranca_TOI_ETO_04_08_2025.csv'...
2025-08-04 15:09:52,127 - INFO - [data_exporter:39] - Exportação de dados concluída com sucesso.
2025-08-04 15:09:52,128 - INFO - [main:35] - --- ESTÁGIO 3 CONCLUÍDO ---
2025-08-04 15:09:52,129 - INFO - [main:38] - Estado final salvo.
2025-08-04 15:09:52,129 - INFO - [main:40] - ================================ PROCESSO CONCLUÍDO COM SUCESSO ================================
2025-08-04 15:27:56,763 - INFO - [logger_setup:49] - Logger configurado com sucesso.
2025-08-04 15:27:56,763 - INFO - [main:21] - ============================== INÍCIO DO PROCESSO DE AUTOMAÇÃO ==============================
2025-08-04 15:27:56,763 - INFO - [state_manager:29] - Estado anterior carregado com sucesso de './state.json'.
2025-08-04 15:27:56,763 - INFO - [main:25] - --- ESTÁGIO 1: Carregando arquivos de dados ---
2025-08-04 15:27:56,764 - INFO - [data_loader:29] - Arquivo mais recente encontrado para 'MAILING_NUCLEO_*.xlsx': MAILING_NUCLEO_2025-07-30.xlsx
2025-08-04 15:27:56,764 - INFO - [data_loader:35] - Carregando arquivo Excel: MAILING_NUCLEO_2025-07-30.xlsx...
2025-08-04 15:31:30,453 - INFO - [data_loader:43] - Carregado com sucesso. 252981 linhas.
2025-08-04 15:31:30,453 - INFO - [data_loader:57] - Carregando arquivos de PAGAMENTOS com o padrão 'PAGOS_*.csv'...
2025-08-04 15:31:40,810 - INFO - [data_loader:78] - Carregados e concatenados 9 arquivos de pagamento, totalizando 7938289 linhas.
2025-08-04 15:31:40,972 - WARNING - [data_loader:24] - Arquivo opcional com padrão 'Dump_TabAuto_*.txt' não encontrado. Continuando.
2025-08-04 15:31:40,972 - INFO - [data_loader:35] - Carregando arquivo Excel: Pontuação.xlsx...
2025-08-04 15:31:49,763 - INFO - [data_loader:49] - Carregado com sucesso. Encontradas 2 abas.
2025-08-04 15:31:49,763 - INFO - [data_loader:35] - Carregando arquivo Excel: Negociações SINED.xlsx...
2025-08-04 15:32:04,821 - INFO - [data_loader:43] - Carregado com sucesso. 97690 linhas.
2025-08-04 15:32:04,821 - INFO - [data_loader:35] - Carregando arquivo Excel: Tabulações para Retirar.xlsx...
2025-08-04 15:32:05,705 - INFO - [data_loader:43] - Carregado com sucesso. 13033 linhas.
2025-08-04 15:32:05,705 - INFO - [data_loader:117] - Todos os arquivos de dados foram carregados com sucesso.
2025-08-04 15:32:05,705 - INFO - [main:27] - --- ESTÁGIO 1 CONCLUÍDO ---
2025-08-04 15:32:05,705 - INFO - [main:29] - --- ESTÁGIO 2: Processando dados (Alquimia) ---
2025-08-04 15:32:05,705 - INFO - [processing_pipeline:179] - >>> INICIANDO PIPELINE DE PROCESSAMENTO DE DADOS <<<
2025-08-04 15:32:06,003 - INFO - [processing_pipeline:60] - Iniciando higienização da base...
2025-08-04 15:32:06,056 - INFO - [processing_pipeline:23] - Deduplicação: Removidos 169644 registros duplicados com base na coluna 'NCPF'.
2025-08-04 15:32:06,056 - INFO - [processing_pipeline:34] - Iniciando higienização por tabulações de discagem...
2025-08-04 15:32:06,056 - WARNING - [processing_pipeline:38] - Arquivo de tabulacoes para retirar não encontrado. Pulando etapa.
2025-08-04 15:32:06,056 - INFO - [processing_pipeline:64] - Higienização concluída. Registros restantes: 83337
2025-08-04 15:32:06,094 - INFO - [processing_pipeline:71] - Verificando clientes em negociação para a coluna 'Cliente_Regulariza'...
2025-08-04 15:32:06,094 - WARNING - [processing_pipeline:73] - Base de negociações não foi carregada. Coluna 'Cliente_Regulariza' será preenchida com 'NÃO'.
2025-08-04 15:32:06,095 - INFO - [processing_pipeline:98] - Iniciando processo de enriquecimento de telefones...
2025-08-04 15:32:06,095 - WARNING - [processing_pipeline:104] - Nenhum dado de pontuacao encontrado. Pulando etapa de enriquecimento.
2025-08-04 15:32:06,096 - INFO - [processing_pipeline:134] - Criando, formatando e reordenando colunas finais...
2025-08-04 15:32:06,267 - INFO - [processing_pipeline:203] - >>> PIPELINE DE PROCESSAMENTO CONCLUÍDO. TOTAL DE 83337 REGISTROS GERADOS. <<<
2025-08-04 15:32:06,280 - INFO - [main:31] - --- ESTÁGIO 2 CONCLUÍDO ---
2025-08-04 15:32:06,280 - INFO - [main:33] - --- ESTÁGIO 3: Exportando arquivos finais ---
2025-08-04 15:32:06,280 - INFO - [data_exporter:14] - Iniciando exportação dos dados processados...
2025-08-04 15:32:06,284 - INFO - [data_exporter:30] - Encontrados 9 produtos únicos para particionamento.
2025-08-04 15:32:06,333 - INFO - [data_exporter:36] - Exportando 5305 linhas para o produto 'EAC' em 'data_output/Telecobranca_TOI_EAC_04_08_2025.csv'...
2025-08-04 15:32:06,421 - INFO - [data_exporter:36] - Exportando 218 linhas para o produto 'EMR' em 'data_output/Telecobranca_TOI_EMR_04_08_2025.csv'...
2025-08-04 15:32:06,425 - INFO - [data_exporter:36] - Exportando 5709 linhas para o produto 'EMS' em 'data_output/Telecobranca_TOI_EMS_04_08_2025.csv'...
2025-08-04 15:32:06,523 - INFO - [data_exporter:36] - Exportando 21617 linhas para o produto 'EMT' em 'data_output/Telecobranca_TOI_EMT_04_08_2025.csv'...
2025-08-04 15:32:06,888 - INFO - [data_exporter:36] - Exportando 14718 linhas para o produto 'EPB' em 'data_output/Telecobranca_TOI_EPB_04_08_2025.csv'...
2025-08-04 15:32:07,122 - INFO - [data_exporter:36] - Exportando 26025 linhas para o produto 'ERO' em 'data_output/Telecobranca_TOI_ERO_04_08_2025.csv'...
2025-08-04 15:32:07,541 - INFO - [data_exporter:36] - Exportando 8480 linhas para o produto 'ESE' em 'data_output/Telecobranca_TOI_ESE_04_08_2025.csv'...
2025-08-04 15:32:07,690 - INFO - [data_exporter:36] - Exportando 212 linhas para o produto 'ESS' em 'data_output/Telecobranca_TOI_ESS_04_08_2025.csv'...
2025-08-04 15:32:07,694 - INFO - [data_exporter:36] - Exportando 1053 linhas para o produto 'ETO' em 'data_output/Telecobranca_TOI_ETO_04_08_2025.csv'...
2025-08-04 15:32:07,713 - INFO - [data_exporter:39] - Exportação de dados concluída com sucesso.
2025-08-04 15:32:07,727 - INFO - [main:35] - --- ESTÁGIO 3 CONCLUÍDO ---
2025-08-04 15:32:07,728 - INFO - [main:38] - Estado final salvo.
2025-08-04 15:32:07,728 - INFO - [main:40] - ================================ PROCESSO CONCLUÍDO COM SUCESSO ================================
